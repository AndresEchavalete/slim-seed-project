# üöÄ SlimSeed Framework - Arquitectura Hexagonal + DDD + Doctrine ORM

**Framework PHP reutilizable** con **Slim Framework + DDD + Arquitectura Hexagonal + Doctrine ORM** listo para instalar en cualquier proyecto.

> **Instalable via Composer:** `composer require slimseed/framework` - Estructura profesional y escalable.

[![PHP Version](https://img.shields.io/badge/php-8.2+-blue.svg)](https://php.net)
[![Slim Framework](https://img.shields.io/badge/slim-4.15-green.svg)](https://slimframework.com)
[![Doctrine ORM](https://img.shields.io/badge/doctrine-3.5-orange.svg)](https://doctrine-project.org)
[![Docker](https://img.shields.io/badge/docker-ready-blue.svg)](https://docker.com)

## üìã Tabla de Contenidos

- [üèóÔ∏è Arquitectura](#Ô∏è-arquitectura)
- [üöÄ Caracter√≠sticas](#-caracter√≠sticas)
- [üõ†Ô∏è Instalaci√≥n](#Ô∏è-instalaci√≥n)
- [üîß Configuraci√≥n](#-configuraci√≥n)
- [üìö API Documentation](#-api-documentation)
- [üèõÔ∏è Arquitectura Hexagonal](#Ô∏è-arquitectura-hexagonal)
- [üóÑÔ∏è Base de Datos](#Ô∏è-base-de-datos)
- [üß™ Testing](#-testing)
- [üìñ Gu√≠as](#-gu√≠as)

## üèóÔ∏è Arquitectura

### **Principios Implementados**
- ‚úÖ **Arquitectura Hexagonal** (Puertos y Adaptadores)
- ‚úÖ **Domain Driven Design (DDD)**
- ‚úÖ **SOLID Principles**
- ‚úÖ **Inyecci√≥n de Dependencias**
- ‚úÖ **Repository Pattern**
- ‚úÖ **Unit of Work (Doctrine)**

### **Estructura de Capas**

```
src/
‚îú‚îÄ‚îÄ Domain/                    # üéØ CAPA DE DOMINIO
‚îÇ   ‚îú‚îÄ‚îÄ Entities/              # Entidades de negocio (Doctrine)
‚îÇ   ‚îú‚îÄ‚îÄ ValueObjects/          # Objetos de valor
‚îÇ   ‚îú‚îÄ‚îÄ Services/              # üö™ PUERTOS (Interfaces)
‚îÇ   ‚îî‚îÄ‚îÄ Repositories/          # üö™ PUERTOS (Interfaces)
‚îÇ
‚îú‚îÄ‚îÄ Application/               # üéØ CAPA DE APLICACI√ìN
‚îÇ   ‚îú‚îÄ‚îÄ UseCases/              # Casos de uso
‚îÇ   ‚îú‚îÄ‚îÄ DTOs/                  # Data Transfer Objects
‚îÇ   ‚îî‚îÄ‚îÄ Services/              # Servicios de aplicaci√≥n
‚îÇ
‚îú‚îÄ‚îÄ Infrastructure/            # üîå ADAPTADORES
‚îÇ   ‚îú‚îÄ‚îÄ Services/              # Implementaciones de servicios
‚îÇ   ‚îú‚îÄ‚îÄ External/              # Servicios externos (Email, Slack)
‚îÇ   ‚îú‚îÄ‚îÄ Persistence/           # Repositorios Doctrine
‚îÇ   ‚îî‚îÄ‚îÄ Config/                # Configuraciones
‚îÇ
‚îú‚îÄ‚îÄ Presentation/              # üéØ CAPA DE PRESENTACI√ìN
‚îÇ   ‚îú‚îÄ‚îÄ Controllers/           # Controladores HTTP
‚îÇ   ‚îú‚îÄ‚îÄ Middleware/            # Middleware de Slim
‚îÇ   ‚îî‚îÄ‚îÄ Routes/                # Definici√≥n de rutas
‚îÇ
‚îî‚îÄ‚îÄ Shared/                    # üéØ CAPA COMPARTIDA
    ‚îú‚îÄ‚îÄ Container/             # Configuraci√≥n DI
    ‚îî‚îÄ‚îÄ Exceptions/            # Excepciones compartidas
```

## üöÄ Caracter√≠sticas

### **Framework & Tecnolog√≠as**
- **Slim Framework 4.15** - Micro-framework PHP
- **Doctrine ORM 3.5** - Mapeo objeto-relacional
- **PHP-DI 7.1** - Inyecci√≥n de dependencias
- **Monolog 3.9** - Logging avanzado
- **Docker** - Contenedores para desarrollo

### **Funcionalidades Implementadas**
- ‚úÖ **Health Check** - Monitoreo del sistema
- ‚úÖ **Gesti√≥n de Usuarios** - CRUD completo
- ‚úÖ **Notificaciones** - Email y Slack
- ‚úÖ **Historial de Salud** - Persistencia de estados
- ‚úÖ **Migraciones** - Autom√°ticas con Doctrine
- ‚úÖ **API REST** - Endpoints documentados

## üõ†Ô∏è Instalaci√≥n

### **üì¶ Como Paquete de Composer (Para Usuarios)**

```bash
# 1. Crear nuevo proyecto
mkdir mi-api
cd mi-api

# 2. Inicializar Composer
composer init

# 3. Instalar SlimSeed Framework
composer require slimseed/framework

# 4. ¬°Listo! El framework se configura autom√°ticamente
# Se crean autom√°ticamente: .env, docker-compose.yml, public/index.php, etc.

# 5. Configurar variables (opcional)
nano .env

# 6. Levantar contenedores
docker-compose up -d

# 7. Ejecutar migraciones
composer run migrate

# 8. Visitar: http://localhost:8081
```

### **üîß Desarrollo del Framework (Para Contribuidores)**

```bash
# 1. Clonar el repositorio
git clone https://github.com/AndresEchavalete/slim-seed-project.git
cd slim-seed-project

# 2. Instalar dependencias
composer install

# 3. Levantar contenedores
docker-compose up -d

# 4. Ejecutar migraciones
composer run migrate

# 5. ¬°Listo! El framework est√° en http://localhost:8081
```

### **Verificar Instalaci√≥n**

```bash
# Probar endpoint de bienvenida
curl http://localhost:8081/

# Probar health check
curl http://localhost:8081/health
```

## üîß Configuraci√≥n

### **üì¶ Para Usuarios del Paquete**

El archivo `.env` se crea autom√°ticamente al instalar. Puedes editarlo seg√∫n tus necesidades:

```env
# Aplicaci√≥n
APP_ENV=development
APP_DEBUG=true
APP_NAME="Mi Proyecto API"

# Base de datos
DB_HOST=mysql
DB_PORT=3306
DB_NAME=mi_proyecto
DB_USER=mi_usuario
DB_PASS=mi_contrase√±a

# Notificaciones
NOTIFICATION_TYPE=email  # email | slack
ADMIN_EMAIL=admin@mi-proyecto.com
SLACK_WEBHOOK=https://hooks.slack.com/...

# Logging
LOG_LEVEL=debug
```

### **üîß Para Desarrolladores del Framework**

**Puertos del Sistema:**
- **API**: http://localhost:8081
- **MySQL**: localhost:3307
- **Redis**: localhost:6380

**Variables de Entorno:**
```env
# Aplicaci√≥n
APP_ENV=development
APP_DEBUG=true
APP_NAME="Slim Seed Project"

# Base de datos
DB_HOST=mysql
DB_PORT=3306
DB_NAME=slim_seed
DB_USER=slim_user
DB_PASS=slim_pass

# Notificaciones
NOTIFICATION_TYPE=email  # email | slack
ADMIN_EMAIL=admin@example.com
SLACK_WEBHOOK=https://hooks.slack.com/...

# Logging
LOG_LEVEL=debug
```

## üìö API Documentation

### **Endpoints Principales**

#### **üè† Bienvenida**
```http
GET /
```
**Respuesta:**
```json
{
  "message": "¬°Bienvenido a Slim Seed Project!",
  "version": "1.0.0",
  "architecture": "DDD + Hexagonal",
  "framework": "Slim 4 + DI Container",
  "timestamp": "2025-09-26 13:39:39"
}
```

#### **üíö Health Check**
```http
GET /health
```
**Respuesta:**
```json
{
  "healthy": true,
  "message": "All systems operational",
  "checks": {
    "database": true,
    "redis": true,
    "memory": true
  }
}
```

### **üë• Gesti√≥n de Usuarios**

#### **Crear Usuario**
```http
POST /api/users
Content-Type: application/json

{
  "email": "test@example.com",
  "name": "Test User",
  "password": "password123"
}
```

#### **Obtener Usuarios Activos**
```http
GET /api/users/active
```

#### **Obtener Usuario por ID**
```http
GET /api/users/{id}
```

#### **Actualizar Nombre de Usuario**
```http
PUT /api/users/{id}/name
Content-Type: application/json

{
  "name": "Nuevo Nombre"
}
```

#### **Autenticar Usuario**
```http
POST /api/users/authenticate
Content-Type: application/json

{
  "email": "test@example.com",
  "password": "password123"
}
```

### **üìä Historial de Salud**

#### **√öltimo Estado**
```http
GET /api/health/latest
```

#### **Historial por Fechas**
```http
GET /api/health/history?from=2025-09-01&to=2025-09-30
```

### **üîî Notificaciones**

#### **Enviar Alerta**
```http
POST /api/notifications/alert
Content-Type: application/json

{
  "message": "Sistema en mantenimiento",
  "context": {
    "duration": "2 hours"
  }
}
```

#### **Notificaci√≥n de Prueba**
```http
POST /api/notifications/test
```

## üèõÔ∏è Arquitectura Hexagonal

### **Puertos (Interfaces)**

```php
// Domain/Services/HealthCheckServiceInterface.php
interface HealthCheckServiceInterface
{
    public function checkHealth(): HealthCheckResult;
}

// Domain/Repositories/UserRepositoryInterface.php
interface UserRepositoryInterface
{
    public function save(User $user): void;
    public function findById(int $id): ?User;
    public function findByEmail(string $email): ?User;
}
```

### **Adaptadores (Implementaciones)**

```php
// Infrastructure/Services/HealthCheckService.php
class HealthCheckService implements HealthCheckServiceInterface
{
    public function checkHealth(): HealthCheckResult
    {
        // Implementaci√≥n espec√≠fica
    }
}

// Infrastructure/Persistence/DoctrineUserRepository.php
class DoctrineUserRepository implements UserRepositoryInterface
{
    public function save(User $user): void
    {
        $this->entityManager->persist($user);
        $this->entityManager->flush();
    }
}
```

### **Inyecci√≥n de Dependencias**

```php
// Shared/Container/ContainerBuilder.php
HealthCheckServiceInterface::class => \DI\create(HealthCheckService::class)
UserRepositoryInterface::class => \DI\create(DoctrineUserRepository::class)
```

## üóÑÔ∏è Base de Datos

### **Entidades Doctrine**

#### **User Entity**
```php
#[ORM\Entity]
#[ORM\Table(name: 'users')]
class User
{
    #[ORM\Id]
    #[ORM\GeneratedValue]
    #[ORM\Column(type: Types::INTEGER)]
    private ?int $id = null;

    #[ORM\Column(type: Types::STRING, length: 100, unique: true)]
    private string $email;

    #[ORM\Column(type: Types::STRING, length: 255)]
    private string $name;

    #[ORM\Column(type: Types::BOOLEAN)]
    private bool $isActive = true;
}
```

### **Migraciones**

```bash
# Crear esquema de base de datos
docker-compose exec -T app bash -c "cd /var/www/html && php scripts/migrate.php"

# Resetear base de datos
docker-compose exec -T app bash -c "cd /var/www/html && php scripts/reset-db.php"
```

### **Comandos de Desarrollo**

#### **üì¶ Para Usuarios del Paquete**
```bash
# Migraciones
composer run migrate              # Ejecutar migraciones
composer run reset-db             # Resetear BD
composer run migrate:status       # Estado de migraciones

# Docker
docker-compose up -d              # Levantar contenedores
docker-compose down               # Detener contenedores
docker-compose logs -f app        # Ver logs
```

#### **üîß Para Desarrolladores del Framework**
```bash
# Entrar al contenedor
docker-compose exec app bash

# Instalar dependencias
docker-compose exec -T app bash -c "cd /var/www/html && composer install"

# Ver logs
docker-compose logs -f app
```

## üß™ Testing

### **Ejemplos de Pruebas**

```bash
# Crear usuario
curl -X POST http://localhost:8081/api/users \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","name":"Test User","password":"password123"}'

# Obtener usuarios activos
curl http://localhost:8081/api/users/active

# Probar autenticaci√≥n
curl -X POST http://localhost:8081/api/users/authenticate \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}'
```

## üì¶ Uso del Paquete

### **üöÄ Instalaci√≥n R√°pida**

```bash
# 1. Crear proyecto
mkdir mi-api
cd mi-api
composer init

# 2. Instalar SlimSeed Framework
composer require slimseed/framework

# 3. ¬°Listo! Se configura autom√°ticamente
# Se crean: .env, docker-compose.yml, public/index.php, etc.

# 4. Levantar contenedores
docker-compose up -d

# 5. Ejecutar migraciones
composer run migrate

# 6. Visitar: http://localhost:8081
```

### **‚öôÔ∏è Comandos Disponibles**

```bash
# Migraciones
composer run migrate              # Ejecutar migraciones
composer run reset-db             # Resetear BD
composer run migrate:status       # Estado de migraciones

# Instalaci√≥n
composer run slimseed:install     # Re-ejecutar instalador
```

### **üìÅ Estructura Creada**

```
mi-proyecto/
‚îú‚îÄ‚îÄ .env                          # Variables de entorno (creado autom√°ticamente)
‚îú‚îÄ‚îÄ docker-compose.yml            # Configuraci√≥n Docker (creado autom√°ticamente)
‚îú‚îÄ‚îÄ public/index.php              # Punto de entrada (creado autom√°ticamente)
‚îú‚îÄ‚îÄ README.md                     # Documentaci√≥n del proyecto (creado autom√°ticamente)
‚îú‚îÄ‚îÄ migrations/                   # Migraciones de BD (creado autom√°ticamente)
‚îú‚îÄ‚îÄ config/                       # Configuraciones (creado autom√°ticamente)
‚îî‚îÄ‚îÄ vendor/slimseed/framework/    # Paquete instalado
```

### **üéØ Personalizaci√≥n**

Despu√©s de la instalaci√≥n, puedes:
- ‚úÖ Editar `.env` para configurar variables
- ‚úÖ Agregar nuevas entidades en `src/`
- ‚úÖ Crear migraciones personalizadas
- ‚úÖ Modificar rutas y controladores
- ‚úÖ Agregar middleware personalizado

## üìñ Gu√≠as

### **üì¶ Para Usuarios del Paquete**
- [Gu√≠a de Instalaci√≥n](docs/INSTALLATION.md) - C√≥mo instalar y usar el paquete
- [Ejemplo de Uso](examples/quick-start.md) - Tutorial completo paso a paso
- [API Documentation](docs/API.md) - Documentaci√≥n de endpoints

### **üîß Para Desarrolladores del Framework**
- [Gu√≠a de Desarrollo](docs/development.md) - Desarrollo del framework
- [Arquitectura Hexagonal](docs/architecture.md) - Explicaci√≥n de la arquitectura
- [Patrones DDD](docs/ddd-patterns.md) - Patrones de Domain Driven Design

### **üöÄ Despliegue**
- [Docker Production](docs/docker-production.md) - Despliegue con Docker
- [Configuraci√≥n de Servidor](docs/server-setup.md) - Configuraci√≥n de servidor

### **ü§ù Contribuci√≥n**
- [Gu√≠a de Contribuci√≥n](docs/contributing.md) - C√≥mo contribuir al proyecto
- [Est√°ndares de C√≥digo](docs/coding-standards.md) - Est√°ndares de c√≥digo

## üéØ Beneficios de esta Arquitectura

1. **Testabilidad** - F√°cil mock de dependencias
2. **Mantenibilidad** - Separaci√≥n clara de responsabilidades
3. **Flexibilidad** - Intercambio f√°cil de adaptadores
4. **Escalabilidad** - Estructura preparada para crecimiento
5. **Independencia** - El dominio no depende de infraestructura
6. **Productividad** - Desarrollo r√°pido con patrones establecidos

## üöÄ Pr√≥ximos Pasos

- [ ] Autenticaci√≥n JWT
- [ ] Validaci√≥n de entrada con Respect/Validation
- [ ] Tests unitarios con PHPUnit
- [ ] Cache con Redis
- [ ] Documentaci√≥n OpenAPI
- [ ] CI/CD con GitHub Actions

---

**¬°Proyecto listo para desarrollo con Arquitectura Hexagonal completa!** üéâ

**Desarrollado con ‚ù§Ô∏è usando Slim Framework + DDD + Doctrine ORM**